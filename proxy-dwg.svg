<?xml version="1.0" encoding="utf-8" ?>
<svg baseProfile="tiny" height="100%" version="1.2" width="100%"  viewBox="0, 0, 600, 655" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xlink="http://www.w3.org/1999/xlink">

  <defs><g id="simple-arrow"><polyline fill="none" points="-10,4 0,0 -10,-4" stroke="black" stroke-width="1" /></g></defs><text font-family="sans-serif" font-size="20" text-anchor="middle" x="64.4" y="32.1">user-agent</text><line stroke="black" stroke-width="1" x1="64.4" x2="64.4" y1="44.2" y2="645.8" /><text font-family="sans-serif" font-size="20" text-anchor="middle" x="314.4" y="32.1">Proxy</text><line stroke="black" stroke-width="1" x1="314.4" x2="314.4" y1="44.2" y2="645.8" /><text font-family="sans-serif" font-size="20" text-anchor="middle" x="564.4" y="32.1">Server</text><line stroke="black" stroke-width="1" x1="564.4" x2="564.4" y1="44.2" y2="645.8" /><use transform="rotate(0.0,314.4,76.36)" x="314.4" xlink:href="#simple-arrow" y="76.36" /><line stroke="black" stroke-width="1" x1="314.4" x2="64.4" y1="76.36" y2="76.36" /><rect fill="white" height="16.31" stroke="white" width="154.0" x="112.4" y="56.2" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="189.4" y="70.2">(1) TLS ClientHello</text><rect fill="white" height="16.31" stroke="white" width="200.2" x="89.3" y="78.67" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="189.4" y="92.67">(ALPN ProtocolName: http)</text><use transform="rotate(180.0,64.4,127.14)" x="64.4" xlink:href="#simple-arrow" y="127.14" /><line stroke="black" stroke-width="1" x1="314.4" x2="64.4" y1="127.14" y2="127.14" /><rect fill="white" height="16.31" stroke="white" width="107.8" x="135.5" y="106.98" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="189.4" y="120.98">(2) TLS Error</text><rect fill="white" height="16.31" stroke="white" width="100.1" x="139.35" y="129.45" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="189.4" y="143.45">(Proxy Cert)</text><use transform="rotate(180.0,64.4,206.76)" x="64.4" xlink:href="#simple-arrow" y="206.76" /><line stroke="black" stroke-width="1" x1="139.4" x2="64.4" y1="157.76" y2="157.76" /><line stroke="black" stroke-width="1" x1="139.4" x2="139.4" y1="206.76" y2="157.76" /><rect fill="white" height="16.31" stroke="white" width="254.1" x="12.35" y="174.42" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="139.4" y="188.42">(inform user of the SecureProxy)</text><line stroke="black" stroke-width="1" x1="64.4" x2="139.4" y1="206.76" y2="206.76" /><use transform="rotate(0.0,314.4,238.92)" x="314.4" xlink:href="#simple-arrow" y="238.92" /><line stroke="black" stroke-width="1" x1="314.4" x2="64.4" y1="238.92" y2="238.92" /><rect fill="white" height="16.31" stroke="white" width="154.0" x="112.4" y="218.76" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="189.4" y="232.76">(3) TLS ClientHello</text><use transform="rotate(180.0,64.4,271.08)" x="64.4" xlink:href="#simple-arrow" y="271.08" /><line stroke="black" stroke-width="1" x1="314.4" x2="64.4" y1="271.08" y2="271.08" /><rect fill="white" height="16.31" stroke="white" width="123.2" x="127.8" y="250.92" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="189.4" y="264.92">(4) ServerHello</text><rect fill="white" height="21.0" stroke="white" width="252.0" x="63.4" y="283.08" /><text fill="black" font-family="sans-serif" font-size="14" text-anchor="middle" x="189.4" y="330.08">HTTP2.0</text><rect fill="none" height="294.36" stroke="black" width="244.0" x="67.4" y="336.24" /><use transform="rotate(0.0,314.4,358.39)" x="314.4" xlink:href="#simple-arrow" y="358.39" /><line stroke="black" stroke-width="1" x1="314.4" x2="64.4" y1="358.39" y2="358.39" /><rect fill="white" height="16.31" stroke="white" width="138.6" x="120.1" y="350.55" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="189.4" y="364.55">(5) stream(X) GET</text><use transform="rotate(0.0,564.4,407.42)" x="564.4" xlink:href="#simple-arrow" y="407.42" /><line stroke="black" stroke-width="1" x1="564.4" x2="314.4" y1="407.42" y2="407.42" /><rect fill="white" height="16.31" stroke="white" width="154.0" x="362.4" y="387.26" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="439.4" y="401.26">(6) TLS ClientHello</text><use transform="rotate(180.0,314.4,439.58)" x="314.4" xlink:href="#simple-arrow" y="439.58" /><line stroke="black" stroke-width="1" x1="564.4" x2="314.4" y1="439.58" y2="439.58" /><rect fill="white" height="16.31" stroke="white" width="123.2" x="377.8" y="419.42" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="439.4" y="433.42">TLS ServerHello</text><rect fill="white" height="21.0" stroke="white" width="252.0" x="313.4" y="451.58" /><text fill="black" font-family="sans-serif" font-size="14" text-anchor="middle" x="439.4" y="498.58">HTTP2.0</text><rect fill="none" height="125.86" stroke="black" width="244.0" x="317.4" y="504.74" /><use transform="rotate(0.0,564.4,526.89)" x="564.4" xlink:href="#simple-arrow" y="526.89" /><line stroke="black" stroke-width="1" x1="564.4" x2="314.4" y1="526.89" y2="526.89" /><rect fill="white" height="16.31" stroke="white" width="138.6" x="370.1" y="519.05" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="439.4" y="533.05">(7) stream(Z) GET</text><use transform="rotate(180.0,314.4,565.91)" x="314.4" xlink:href="#simple-arrow" y="565.91" /><line stroke="black" stroke-width="1" x1="564.4" x2="314.4" y1="565.91" y2="565.91" /><rect fill="white" height="16.31" stroke="white" width="161.7" x="358.55" y="558.07" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="439.4" y="572.07">(8) stream(Z) 200 OK</text><use transform="rotate(180.0,64.4,604.93)" x="64.4" xlink:href="#simple-arrow" y="604.93" /><line stroke="black" stroke-width="1" x1="314.4" x2="64.4" y1="604.93" y2="604.93" /><rect fill="white" height="16.31" stroke="white" width="161.7" x="108.55" y="597.09" /><text font-family="sans-serif" font-size="14" text-anchor="middle" x="189.4" y="611.09">(9) stream(X) 200 OK</text></svg>
